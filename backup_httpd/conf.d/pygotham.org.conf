<VirtualHost *:80>
   ServerName pygotham.org
   ServerAlias *.pygotham.org pygotham.com *.pygotham.com pygotham.net *.pygotham.net pygotham.us *.pygotham.us
   ServerAdmin strangest@comcast.net
   DocumentRoot /app/pygotham/www
   Alias /static /app/pygotham/static
   Alias /media /app/pygotham/django/contrib/admin/media

   WSGIScriptAlias / /app/pygotham/src/django.wsgi

   CustomLog    /var/log/pygotham/apache-access.log combined
   ErrorLog     /var/log/pygotham/apache-error.log

   RewriteEngine On
   RewriteRule !^(.*)/   http://pygotham.org/$1/

   RewriteCond %{HTTP_HOST}   ^(www\.)?pygotham\.(com|net|us) [NC,OR]
   RewriteCond %{HTTP_HOST}   ^www\.pygotham\.org [NC]
   RewriteCond %{HTTP_HOST}   !^$
   RewriteRule ^/(.*)         http://pygotham.org/$1 [L,R]

   RewriteRule ^(/accounts/register/?.*)         https://pygotham.org/$1 [L,R]

   RewriteRule ^/favicon.ico$ http://pygotham.org/static/images/favicon.ico

   <Location "/admin">
        Options Indexes FollowSymLinks
        Order allow,deny
        Allow from all

        AuthType Basic
        AuthName "Pygotham admin"
        AuthUserFile /app/pygotham/htpasswd
        Require valid-user

   </Location>

   <Location "/static/">
        Options Indexes FollowSymLinks
        Order allow,deny
        Allow from all
        SetHandler None
   </Location>

   <Location "/media/">
        Options Indexes FollowSymLinks
        Order allow,deny
        Allow from all
        SetHandler None
   </Location>

</VirtualHost>
